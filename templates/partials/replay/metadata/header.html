{% set team_members = ((replay.playergames|sort(attribute='score', reverse=False)))|sort(attribute='is_orange', reverse=False) %}
<h2>{{ replay.name|e }}</h2>
<div class="replay-header">
    <div class="player-box blue">
        <!-- Player box -->
        {% set team = team_members|rejectattr('is_orange') %}
        {% include "partials/replay/metadata/players.html" %}
    </div>
    <div class="score-box">
        <!-- SCORE BOX -->
        <div id="scoreBox">
            {% set team_names = ['Blue', 'Orange'] %}

            {% set graphs = ["score", "goals", "assists", "saves", "shots"] %}
            {% set graph_length = graphs|length %}
            {% set json_keys = ["player", "name", "is_orange"] + graphs %}
            <script>
                (function (hostId, labels) {
                    document.addEventListener("DOMContentLoaded", function () {
                        const replayData = [{{ jsonify(team_members, json_keys) }}];
                        requirejs(['overallReplayGraph'], function (replayGraphs) {
                            replayGraphs.showOverallReplayGraphs(hostId, '.graph-list-container', labels, replayData);
                        });
                    });
                })('scoreBox', {{ graphs|tojson }});
            </script>
            {% include "partials/replay/shared/score_graph.html" %}
        </div>
    </div>
    <div class="player-box orange">
        <!-- Player box -->
        {% set team = team_members|rejectattr('is_orange', 'equalto', 0) %}
        {% include "partials/replay/metadata/players.html" %}
    </div>
</div>
<p>Map: {{ replay.map }}</p>
{#        <p>Version: {{ replay.api_game.replay_version }}</p>#}
{#        <p>Time: {{ replay.api_game.datetime }}</p>#}
{#            <p>Frames: {{ frame_count }}</p>#}
{#            <p>Score: {{ replay.teams[0].score }}:{{ replay.api_game.teams[1].score }}</p>#}

